<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Export Excel</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./public/stylesheets/style.css" />
    <style>
      body {
        margin: 0px;
        padding: 0px;
        font: 14px 'Lucida Grande', Helvetica, Arial, sans-serif;
      }
      .top-container {
        background-color: #d6b315;
      }
      h2 {
        margin-left: 100px;
      }
      a {
        color: #00b7ff;
      }
      .form-fill {
        text-align: center;
        margin: auto;
        width: 85%;
        border: 5px dashed lightgray;
        height: 200px;
      }
      input[type='file'] {
        display: none;
        padding: 20px;
      }
      .custom-file-upload {
        border: 1px solid #ccc;
        display: inline-block;
        padding: 6px 12px;
        cursor: pointer;
      }
      input[type='submit'] {
        background-color: #4caf50; /* Green */
        border: none;
        border-radius: 10px;
        color: white;
        padding: 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div>
      <div class="top-container">
        <h1>Add from Excel</h1>
      </div>
      <div>
        <h2>Add Candidates to database.</h2>
      </div>
      <script>
        function validate_fileupload(fileName) {
          var allowed_extensions = new Array('xls', 'xlss');
          var file_extension = fileName.split('.').pop().toLowerCase(); // split function will split the filename by dot(.), and pop function will pop the last element from the array which will give you the extension as well. If there will be no extension then it will return the filename.

          for (var i = 0; i <= allowed_extensions.length; i++) {
            if (allowed_extensions[i] == file_extension) {
              return true; // valid file extension
            }
          }

          return false;
        }
      </script>
      <div class="form-fill">
        <form action="/uploadfile" enctype="multipart/form-data" method="post">
          <label class="custom-file-upload">
            <input
              type="file"
              name="uploadfile"
              accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
              onchange="validate_fileupload(this.value);"
            />
            Excel File Upload
          </label>
          <br />
          <span>Upload a .xls or .xlss file</span>
          <br />
          <input type="submit" value="Upload Excel" />
        </form>
      </div>
    </div>
  </body>
</html>
